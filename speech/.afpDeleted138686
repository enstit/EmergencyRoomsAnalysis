\documentclass[8pt,english,aspectratio=169]{beamer}
\mode<presentation>
{
  \usetheme{Pittsburgh}
  \usecolortheme{seagull}
  \usefonttheme{structurebold}
  \setbeamertemplate{navigation symbols}{}
  \setbeamertemplate{caption}[numbered]
}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[binary-units=true]{siunitx}

\usepackage{pgfpages}
\setbeamertemplate{note page}[plain]
\setbeameroption{show notes on second screen=right}

\usepackage[yyyymmdd]{datetime}
\renewcommand{\dateseparator}{--}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{hyperref}

\usepackage{tikz}
\usetikzlibrary{positioning,arrows}
\tikzset{
block/.style={
  draw, 
  rectangle, 
  align=center
  }, 
line/.style={->,>=latex'}
}


\title[FVG Emergency Rooms situation]{FVG Emergency Rooms situation\\during Spring 2021\\\smallskip \small Data science project}
\author[\href{mailto:stefanel.enrico@spes.uniud.it}{Enrico Stefanel}]{Enrico Stefanel\\137411\\\href{mailto:stefanel.enrico@spes.uniud.it}{\texttt{stefanel.enrico@spes.uniud.it}}}
\date{\today}

\begin{document}


\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{Data collection}
Friuli-Venezia Giulia region offers to the citizens the possibility to check live loads and average timings for every Emergency Room in the territory, thru the ``\href{https://servizionline.sanita.fvg.it/psonline}{Situazione nei Pronto Soccorso}'' web service, powered by \href{https://www.insiel.it/}{Insiel S.p.A.}.

Every 10 minutes since 2021-03-23, I run a Python script on my Raspberry Pi to collect this data and save it into a CSV file.

\medskip
\begin{center}
\begin{tikzpicture}
\node[block](a){JSON file};
\node[block, right=1.25cm of a](b){CSV file};
\node[block, right=1.25cm of b](c){RStudio};
\node[block, below=0.75cm of a](d){Web service};
\draw[line] (a.south) -- node[right] {\small Javascript} (d.north);
\draw[line] (a.east) -- node[above] {\small Python} (b.west);
\draw[line] (b.east) -- node[above] {\small R} (c.west);
\end{tikzpicture}
\end{center}
\bigskip

You can find the R Notebook of this project \href{http://uniud.enricostefanel.it/datascience}{\color{gray}{at this link}}, and the raw dataset \href{http://uniud.enricostefanel.it/datascience/download}{\color{gray}{here}}.

\begin{block}{Disclaimer}
This study does not analyse COVID-19 situation in Friuli-Venezia Giulia: Emergency Rooms load is not a good index for COVID diffusion, since patients need treatments also for many other causes, such as domestic accidents, allergic manifestations, car crashes, \dots 
\end{block}

\note{Il mio progetto di \textit{Data Science} consiste nell'analisi delle presenze nei Pronto Soccorso della Regione dal 23 marzo ad oggi.

I dati sono stati raccolti in maniera automatica ogni 10 minuti, tramite uno \textit{script} Python che gira su un Raspberry Pi 4, e sono stati resi disponibili su Kaggle.

}
\end{frame}
\begin{frame}{Dataset}
The full dataset has three tables, but we only used two of them:

\begin{enumerate}
	\item \textbf{emergencyRooms}, with the list of all of the Emergency rooms in Friuli-Venezia Giulia;
		\begin{center}\small
			\begin{tabular}{ |c|c|c|c|c|c|c| }
				\hline
				\textbf{emergency\_room} & \textbf{is\_pediatric} & \textbf{hospital} & \textbf{healtcare\_company} & \textbf{longitude} & \dots \\
				\hline
				\dots & \dots & \dots & \dots & \dots & \dots \\
				\hline
				Pronto Soccorso Cattinara & FALSE & Ospedale di Cat\dots & ASU - Giuliano Isontina & 13.82627 & \dots \\
				\hline
				\dots & \dots & \dots & \dots & \dots & \dots \\
				\hline
			\end{tabular}
		\end{center}
	\item \textbf{attendances};
		\begin{center}\small
			\begin{tabular}{ |c|c|c|c|c|c| }
				\hline
				\textbf{timestamp} & \textbf{emergency\_room} & \textbf{priority} & \textbf{examined\_p\dots} & \textbf{waiting\_p\dots} & \textbf{waiting\_time} \\
				\hline
				\dots & \dots & \dots & \dots & \dots & \dots \\
				\hline
				1616454020000 & Pronto Soccorso Cattinara & Bianco & 2 & 1 & 02:36:00 \\
				\hline
				1616454020000 & Pronto Soccorso Cattinara & Verde & 25 & 7 & 02:03:00 \\
				\hline
				1616454020000 & Pronto Soccorso Cattinara & Giallo & 17 & 0 & 00:28:00 \\
				\hline
				1616454020000 & Pronto Soccorso Cattinara & Rosso & 1 & 0 & 00:02:00 \\
				\hline
				\dots & \dots & \dots & \dots & \dots & \dots \\
				\hline
			\end{tabular}
		\end{center}
	\item \textbf{COVIDLocalRiskValuation} (unused in this studio).
		\begin{center}\small
			\begin{tabular}{ |c|c| }
				\hline
				\textbf{timestamp} & \textbf{risk} \\
				\hline
				1614639600000 & high risk \\
				\hline
				1618178400000 & medium-high risk \\
				\hline
				\dots & \dots \\
				\hline
			\end{tabular}
		\end{center}

\end{enumerate}

\note{Il dataset utilizzato era formato da tre tabelle:
	\begin{enumerate}
		\item \textbf{emergencyRooms}, che contiene l'elenco di tutti i Pronto Soccorso della Regione, con relative Aziende Sanitarie di appartenenza, indirizzo, eventuali note, \dots
		\item \textbf{attendances}, che è la tabella più corposa del dataset, e viene aggiornata ogni 10 minuti con il numero di pazienti sotto esame, in attesa e relativi tempi di attesa per ogni codice di priorità in ogni Pronto Soccorso della Regione. Allo stato attuale, questa tabella pesa oltre \SI{45}{\mega\byte};
		\item \textbf{COVIDLocalRiskValuation}, che contiene l'elenco delle istituzioni delle varie aree di rischio nella Regione (zona rossa, zona arancione, zona gialla, zona bianca). È una tabella che ho aggiunto in un secondo momento, e che può essere utilizzata in maniera facoltativa per studiare se il COVID ha avuto un impatto significativo sul Sistema Sanitario regionale.
	\end{enumerate}
}

\end{frame}


\begin{frame}{Challenges}
Some questions we could ask about our scenario are, for instance:
\begin{enumerate}
	\item Which is the most used hospital?
	\item Is there any area in Friuli-Venezia Giulia that is poorly covered by Emergency system?
	\item Is \textit{waiting time} related to \textit{color priority}? If yes, how?
	\item How does Emergency Rooms entrance variate, during week days? Are there any days of week in which Emergency Rooms are more empty, compared to other days?
\end{enumerate}

\note{Prima di iniziare a lavorare sul dataset mi sono posto alcune domande:
\begin{enumerate}
	\item Qual è l'ospedale maggiormente utilizzato?
	\item Ci sono aree in Friuli-Venezia Giulia che sono scarsamente coperte dal Sistema di Emergenza Regionale?
	\item Il \textit{tempo di attesa} è correlato alla \textit{priorità}? Se si, in che modo?
	\item Come variano le presenze nei Pronto Soccorso durante i giorni della settimana? Ci sono alcuni giorni in cui i Pronto Soccorso sono mediamente meno affollati (ad esempio durante i fine settimana)?
\end{enumerate}
}

\end{frame}


\subsection{First sub}
\begin{frame}
\begin{figure}
  \centering
  \includegraphics[width=0.75\textwidth]{../images/map.pdf}
\end{figure}
\note{
Prima di tutto, ho visualizzato la localizzazione dei Pronto Soccorso sul territorio della regione.

Da questa mappa possiamo già notare alcune importanti proprietà:
\begin{enumerate}
	\item il colore corrisponde all'Azienda Sanitaria di appartenenza:
		\begin{itemize}
			\item in \textcolor{orange}{arancione}, l'\textit{AS - Friuli Occidentale} comprende gli ospedali che si trovano nel territorio dell'ex provincia di Pordenone;
			\item in \textcolor{red}{rosso}, l'\textit{ASU - Friuli Centrale} comprende gli ospedali che si trovano nel territorio dell'ex provincia di Udine;
			\item in \textcolor{blue}{blu}, l'\textit{ASU - Giuliano Isontina} comprende gli ospedali che si trovano nel territorio delle ex province di Gorizia e Trieste.
		\end{itemize}
	\item la dimensione del cerchio è proporzionale alla mediana del numero di pazienti che si trovano presso Pronto Soccorso in questione. Si nota già, come vedremo anche di seguito, che i Pronto Soccorso più numerosi sono quelli di Udine e Cattinara.
	\item alcuni cerchi sono semi-trasparenti (è il caso del Pronto Soccorso di Maniago e di Gemona del Friuli), perché sono chiusi a causa dell'emergenza da COVID-19.
\end{enumerate}
Notiamo che, nonostante il Pronto Soccorso di Tolmezzo sia l'unico Pronto Soccorso nella zona montana (che si estende per circa un terzo del territorio della Regione), non è tra i Pronto Soccorso maggiormente stressati.
}
\end{frame}

\begin{frame}
\begin{figure}
  \centering
  \includegraphics[width=0.75\textwidth]{../images/01_loads_boxplot.jpg}
\end{figure}
\note{Questo grafico con \textit{boxplot} ci conferma quanto avevamo già osservato nella slide precedente, ovvero:
	\begin{itemize}
		\item che il Pronto Soccorso di Udine è quello più ``frequentato'', ed inoltre notiamo che è anche quello con varianza maggiore;
		\item che il Pronto Soccorso di Cattinara è il secondo più ``frequentato'' dopo quello di Udine, mentre c'è un notevole distacco dai seguenti;
		\item i primi tre Pronto Soccorso, in ordine di saturazione, coprono tutti e tre le Aziende Sanitarie del territorio;
		\item i valori \textit{outliers} stanno tutti a destra della mediana, e in particolare tutti i \textit{baffi} sono più lunghi a destra che a sinistra. Questo significa che la singola distribuzione di presenze per Pronto Soccorso è sbilanciata verso sinistra;
	\end{itemize}

}
\end{frame}

\begin{frame}
\begin{figure}
  \centering
  \includegraphics[width=0.75\textwidth]{../images/03_loads_trendlines-divided.jpg}
\end{figure}
\note{Questo grafico invece ci indica come sono variate le presenze nell'arco temporale dal 23 marzo 2021 ad oggi, relativo ai Pronto Soccorso con almeno 15 pazienti come mediana, ovvero quelli di Udine, Cattinara a Trieste, Pordenone e Monfalcone.}
\end{frame}

\begin{frame}
\begin{figure}
  \centering
  \includegraphics[width=0.75\textwidth]{../images/05_priority_scatterplot.jpg}
\end{figure}
\note{This is the end}
\end{frame}

\begin{frame}
\begin{figure}
  \centering
  \includegraphics[width=0.75\textwidth]{../images/08_waiting-examined_waffle.jpg}
\end{figure}
\note{Say ``hello'' for the last time}
\end{frame}

\begin{frame}
\begin{figure}
  \centering
  \includegraphics[width=0.75\textwidth]{../images/09_priority_waffle.jpg}
\end{figure}
\note{Say ``hello'' for the last time}
\end{frame}

\begin{frame}
You can find the animated plot of average loads during daytime, per day of week, \href{http://uniud.enricostefanel.it/datascience}{\color{gray}{at this link}}.
\end{frame}


\begin{frame}{Conclusions}
We used \textit{data analysis} and \textit{data visualization}

\note{In conclusione, in questo progetto si sono analizzate \dots}

\end{frame}


\end{document}